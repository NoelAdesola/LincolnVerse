{"ast":null,"code":"// src/pages/MediaDetail.js\nimport React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import{getMediaDetails,addFavorite}from'../services/api';import{Container,Box,Typography,Button,CircularProgress,CardMedia,Alert}from'@mui/material';import FavoriteBorderIcon from'@mui/icons-material/FavoriteBorder';import FavoriteIcon from'@mui/icons-material/Favorite';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MediaDetail=_ref=>{let{user}=_ref;const{type,id}=useParams();const navigate=useNavigate();const[media,setMedia]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[favorited,setFavorited]=useState(false);// Fetch media details on mount\nuseEffect(()=>{setLoading(true);getMediaDetails(type,id).then(res=>{setMedia(res.data);setError('');}).catch(()=>setError('Failed to load media details.')).finally(()=>setLoading(false));},[type,id]);useEffect(()=>{getFavorites().then(res=>{if(res.data.find(f=>f.media_id===media.id.toString())){setFavorited(true);}}).catch(()=>{});},[media===null||media===void 0?void 0:media.id]);// Download handler\nconst handleDownload=async()=>{try{var _media$url$match;const resp=await fetch(media.url,{mode:'cors'});const blob=await resp.blob();const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;const ext=((_media$url$match=media.url.match(/\\.\\w+$/))===null||_media$url$match===void 0?void 0:_media$url$match[0])||'';a.download=(media.title||id).replace(/\\s+/g,'_')+ext;document.body.appendChild(a);a.click();a.remove();URL.revokeObjectURL(url);}catch{setError('Download failed.');}};/*#__PURE__*/_jsx(Button,{variant:favorited?'outlined':'contained',color:\"secondary\",startIcon:favorited?/*#__PURE__*/_jsx(FavoriteIcon,{}):/*#__PURE__*/_jsx(FavoriteBorderIcon,{}),onClick:handleFavorite,disabled:favorited,children:favorited?'Favorited':'Add to Favorites'});// Favorite handler\nconst handleFavorite=async()=>{if(!user){setError('Please log in to favorite.');return;}try{await addFavorite({media_id:media.id,media_type:type,title:media.title,thumbnail_url:media.thumbnail||media.url,url:media.url});setFavorited(true);}catch{setError('Could not add to favorites.');}};if(loading)return/*#__PURE__*/_jsx(Container,{sx:{py:4,textAlign:'center'},children:/*#__PURE__*/_jsx(CircularProgress,{})});if(error)return/*#__PURE__*/_jsxs(Container,{sx:{py:4},children:[/*#__PURE__*/_jsx(Alert,{severity:\"error\",children:error}),/*#__PURE__*/_jsx(Box,{mt:2,children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:()=>navigate(-1),children:\"\\u2190 Back\"})})]});return/*#__PURE__*/_jsxs(Container,{sx:{py:4},children:[/*#__PURE__*/_jsx(Box,{mb:3,children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:()=>navigate(-1),children:\"\\u2190 Back to results\"})}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:media.title||'Untitled'}),media.creator_display_name&&/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle2\",color:\"text.secondary\",gutterBottom:true,children:[\"By \",media.creator_display_name]}),/*#__PURE__*/_jsx(CardMedia,{component:type==='audio'?'audio':type==='video'?'video':'img',src:media.url,controls:type!=='images',alt:media.title,sx:{width:'100%',maxHeight:600,objectFit:'contain',mb:2}}),/*#__PURE__*/_jsxs(Box,{display:\"flex\",gap:2,mb:2,children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleDownload,children:\"Download\"}),/*#__PURE__*/_jsx(Button,{variant:favorited?'outlined':'contained',color:\"secondary\",startIcon:favorited?/*#__PURE__*/_jsx(FavoriteIcon,{}):/*#__PURE__*/_jsx(FavoriteBorderIcon,{}),onClick:handleFavorite,children:favorited?'Favorited':'Add to Favorites'})]}),media.description&&/*#__PURE__*/_jsx(Typography,{paragraph:true,children:media.description})]});};export default MediaDetail;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","getMediaDetails","addFavorite","Container","Box","Typography","Button","CircularProgress","CardMedia","Alert","FavoriteBorderIcon","FavoriteIcon","jsx","_jsx","jsxs","_jsxs","MediaDetail","_ref","user","type","id","navigate","media","setMedia","loading","setLoading","error","setError","favorited","setFavorited","then","res","data","catch","finally","getFavorites","find","f","media_id","toString","handleDownload","_media$url$match","resp","fetch","url","mode","blob","URL","createObjectURL","a","document","createElement","href","ext","match","download","title","replace","body","appendChild","click","remove","revokeObjectURL","variant","color","startIcon","onClick","handleFavorite","disabled","children","media_type","thumbnail_url","thumbnail","sx","py","textAlign","severity","mt","mb","gutterBottom","creator_display_name","component","src","controls","alt","width","maxHeight","objectFit","display","gap","description","paragraph"],"sources":["C:/Users/Student/Desktop/Scratch/LincolnVerse/LincolnVerse/frontend/src/pages/MediaDetail.js"],"sourcesContent":["// src/pages/MediaDetail.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { getMediaDetails, addFavorite } from '../services/api';\r\nimport {\r\n  Container,\r\n  Box,\r\n  Typography,\r\n  Button,\r\n  CircularProgress,\r\n  CardMedia,\r\n  Alert\r\n} from '@mui/material';\r\nimport FavoriteBorderIcon from '@mui/icons-material/FavoriteBorder';\r\nimport FavoriteIcon from '@mui/icons-material/Favorite';\r\n\r\nconst MediaDetail = ({ user }) => {\r\n  const { type, id } = useParams();\r\n  const navigate     = useNavigate();\r\n\r\n  const [media,    setMedia]     = useState(null);\r\n  const [loading,  setLoading]   = useState(true);\r\n  const [error,    setError]     = useState('');\r\n  const [favorited, setFavorited] = useState(false);\r\n\r\n  // Fetch media details on mount\r\n  useEffect(() => {\r\n    setLoading(true);\r\n    getMediaDetails(type, id)\r\n      .then(res => {\r\n        setMedia(res.data);\r\n        setError('');\r\n      })\r\n      .catch(() => setError('Failed to load media details.'))\r\n      .finally(() => setLoading(false));\r\n  }, [type, id]);\r\n\r\n  useEffect(() => {\r\n    getFavorites()\r\n      .then(res => {\r\n        if (res.data.find(f => f.media_id === media.id.toString())) {\r\n          setFavorited(true);\r\n        }\r\n      })\r\n      .catch(() => {});\r\n  }, [media?.id]);\r\n\r\n  // Download handler\r\n  const handleDownload = async () => {\r\n    try {\r\n      const resp = await fetch(media.url, { mode: 'cors' });\r\n      const blob = await resp.blob();\r\n      const url  = URL.createObjectURL(blob);\r\n      const a    = document.createElement('a');\r\n      a.href     = url;\r\n      const ext   = media.url.match(/\\.\\w+$/)?.[0] || '';\r\n      a.download = (media.title || id).replace(/\\s+/g,'_') + ext;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      a.remove();\r\n      URL.revokeObjectURL(url);\r\n    } catch {\r\n      setError('Download failed.');\r\n    }\r\n  };\r\n<Button\r\n  variant={favorited ? 'outlined' : 'contained'}\r\n  color=\"secondary\"\r\n  startIcon={favorited \r\n     ? <FavoriteIcon/> \r\n     : <FavoriteBorderIcon/>}\r\n  onClick={handleFavorite}\r\n  disabled={favorited}\r\n>\r\n  {favorited ? 'Favorited' : 'Add to Favorites'}\r\n</Button>\r\n\r\n  // Favorite handler\r\n  const handleFavorite = async () => {\r\n    if (!user) {\r\n      setError('Please log in to favorite.');\r\n      return;\r\n    }\r\n    try {\r\n      await addFavorite({\r\n        media_id:      media.id,\r\n        media_type:    type,\r\n        title:         media.title,\r\n        thumbnail_url: media.thumbnail || media.url,\r\n        url:           media.url\r\n      });\r\n      setFavorited(true);\r\n    } catch {\r\n      setError('Could not add to favorites.');\r\n    }\r\n  };\r\n\r\n  if (loading) return (\r\n    <Container sx={{ py:4,textAlign:'center' }}>\r\n      <CircularProgress />\r\n    </Container>\r\n  );\r\n\r\n  if (error) return (\r\n    <Container sx={{ py:4 }}>\r\n      <Alert severity=\"error\">{error}</Alert>\r\n      <Box mt={2}>\r\n        <Button variant=\"outlined\" onClick={() => navigate(-1)}>\r\n          ← Back\r\n        </Button>\r\n      </Box>\r\n    </Container>\r\n  );\r\n\r\n  return (\r\n    <Container sx={{ py:4 }}>\r\n      <Box mb={3}>\r\n        <Button variant=\"outlined\" onClick={() => navigate(-1)}>\r\n          ← Back to results\r\n        </Button>\r\n      </Box>\r\n\r\n      <Typography variant=\"h4\" gutterBottom>\r\n        {media.title || 'Untitled'}\r\n      </Typography>\r\n      {media.creator_display_name && (\r\n        <Typography variant=\"subtitle2\" color=\"text.secondary\" gutterBottom>\r\n          By {media.creator_display_name}\r\n        </Typography>\r\n      )}\r\n\r\n      <CardMedia\r\n        component={ type === 'audio' ? 'audio'\r\n                  : type === 'video' ? 'video'\r\n                  : 'img' }\r\n        src={media.url}\r\n        controls={type!=='images'}\r\n        alt={media.title}\r\n        sx={{\r\n          width: '100%',\r\n          maxHeight: 600,\r\n          objectFit: 'contain',\r\n          mb: 2\r\n        }}\r\n      />\r\n\r\n      <Box display=\"flex\" gap={2} mb={2}>\r\n        <Button variant=\"contained\" onClick={handleDownload}>\r\n          Download\r\n        </Button>\r\n        <Button\r\n          variant={favorited ? 'outlined' : 'contained'}\r\n          color=\"secondary\"\r\n          startIcon={ favorited ? <FavoriteIcon/> : <FavoriteBorderIcon/> }\r\n          onClick={handleFavorite}\r\n        >\r\n          {favorited ? 'Favorited' : 'Add to Favorites'}\r\n        </Button>\r\n      </Box>\r\n\r\n      {media.description && (\r\n        <Typography paragraph>\r\n          {media.description}\r\n        </Typography>\r\n      )}\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default MediaDetail;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}