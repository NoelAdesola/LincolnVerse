{"ast":null,"code":"// src/pages/History.js\nimport React,{useState,useEffect}from'react';import{Container,Box,Typography,Tabs,Tab,List,ListItem,ListItemText,IconButton,Button,CircularProgress,Alert,Divider}from'@mui/material';import ReplayIcon from'@mui/icons-material/Replay';import DeleteIcon from'@mui/icons-material/Delete';import{useNavigate}from'react-router-dom';import{getSearchHistory,deleteSearch,getFavorites,removeFavorite}from'../services/api';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const History=_ref=>{let{user}=_ref;const navigate=useNavigate();const[tab,setTab]=useState(0);const[historyItems,setHistoryItems]=useState([]);const[favorites,setFavorites]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');// Fetch both history and favorites on mount\nuseEffect(()=>{setLoading(true);Promise.all([getSearchHistory(),getFavorites()]).then(_ref2=>{let[histRes,favRes]=_ref2;setHistoryItems(histRes.data||[]);setFavorites(favRes.data||[]);setError('');}).catch(()=>{setError('Failed to load your history or favorites.');}).finally(()=>{setLoading(false);});},[]);const handleDeleteHistory=async id=>{try{await deleteSearch(id);setHistoryItems(items=>items.filter(i=>i.id!==id));}catch{setError('Could not delete that history item.');}};const handleDeleteFavorite=async id=>{try{await removeFavorite(id);setFavorites(items=>items.filter(i=>i.id!==id));}catch{setError('Could not remove that favorite.');}};const handleReRun=query=>{// Navigate to home with state (Home component can read location.state.query to auto-search)\nnavigate('/',{state:{query}});};if(!user){return/*#__PURE__*/_jsxs(Container,{sx:{py:4,textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"Please sign in to view your history and favorites.\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:()=>navigate('/login'),sx:{mt:2},children:\"Go to Sign In\"})]});}if(loading){return/*#__PURE__*/_jsx(Container,{sx:{py:4,textAlign:'center'},children:/*#__PURE__*/_jsx(CircularProgress,{})});}return/*#__PURE__*/_jsxs(Container,{maxWidth:\"md\",sx:{py:4},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:\"Your Activity\"}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:2},children:error}),/*#__PURE__*/_jsxs(Tabs,{value:tab,onChange:(_,v)=>setTab(v),sx:{mb:2},children:[/*#__PURE__*/_jsx(Tab,{label:\"Search History\"}),/*#__PURE__*/_jsx(Tab,{label:\"Favorites\"})]}),/*#__PURE__*/_jsx(Divider,{}),tab===0&&/*#__PURE__*/_jsxs(List,{children:[historyItems.length===0&&/*#__PURE__*/_jsx(Typography,{sx:{mt:2},children:\"No search history found.\"}),historyItems.map(item=>/*#__PURE__*/_jsx(ListItem,{secondaryAction:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(IconButton,{edge:\"end\",\"aria-label\":\"re-run search\",onClick:()=>handleReRun(item.query),children:/*#__PURE__*/_jsx(ReplayIcon,{})}),/*#__PURE__*/_jsx(IconButton,{edge:\"end\",\"aria-label\":\"delete history\",onClick:()=>handleDeleteHistory(item.id),children:/*#__PURE__*/_jsx(DeleteIcon,{})})]}),children:/*#__PURE__*/_jsx(ListItemText,{primary:item.query,secondary:new Date(item.created_at).toLocaleString()})},item.id))]}),tab===1&&/*#__PURE__*/_jsxs(List,{children:[favorites.length===0&&/*#__PURE__*/_jsx(Typography,{sx:{mt:2},children:\"No favorites saved.\"}),favorites.map(item=>/*#__PURE__*/_jsx(ListItem,{secondaryAction:/*#__PURE__*/_jsx(IconButton,{edge:\"end\",\"aria-label\":\"remove favorite\",onClick:()=>handleDeleteFavorite(item.id),children:/*#__PURE__*/_jsx(DeleteIcon,{})}),children:/*#__PURE__*/_jsx(ListItemText,{primary:item.title||item.query,secondary:new Date(item.created_at).toLocaleString()})},item.id))]})]});};export default History;","map":{"version":3,"names":["React","useState","useEffect","Container","Box","Typography","Tabs","Tab","List","ListItem","ListItemText","IconButton","Button","CircularProgress","Alert","Divider","ReplayIcon","DeleteIcon","useNavigate","getSearchHistory","deleteSearch","getFavorites","removeFavorite","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","History","_ref","user","navigate","tab","setTab","historyItems","setHistoryItems","favorites","setFavorites","loading","setLoading","error","setError","Promise","all","then","_ref2","histRes","favRes","data","catch","finally","handleDeleteHistory","id","items","filter","i","handleDeleteFavorite","handleReRun","query","state","sx","py","textAlign","children","variant","onClick","mt","maxWidth","gutterBottom","severity","mb","value","onChange","_","v","label","length","map","item","secondaryAction","edge","primary","secondary","Date","created_at","toLocaleString","title"],"sources":["C:/Users/Student/Desktop/Scratch/LincolnVerse/LincolnVerse/frontend/src/pages/History.js"],"sourcesContent":["// src/pages/History.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport {\r\n  Container,\r\n  Box,\r\n  Typography,\r\n  Tabs,\r\n  Tab,\r\n  List,\r\n  ListItem,\r\n  ListItemText,\r\n  IconButton,\r\n  Button,\r\n  CircularProgress,\r\n  Alert,\r\n  Divider\r\n} from '@mui/material';\r\nimport ReplayIcon from '@mui/icons-material/Replay';\r\nimport DeleteIcon from '@mui/icons-material/Delete';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport {\r\n  getSearchHistory,\r\n  deleteSearch,\r\n  getFavorites,\r\n  removeFavorite\r\n} from '../services/api';\r\n\r\nconst History = ({ user }) => {\r\n  const navigate = useNavigate();\r\n  const [tab, setTab] = useState(0);\r\n  const [historyItems, setHistoryItems] = useState([]);\r\n  const [favorites, setFavorites] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n\r\n  // Fetch both history and favorites on mount\r\n  useEffect(() => {\r\n    setLoading(true);\r\n    Promise.all([getSearchHistory(), getFavorites()])\r\n      .then(([histRes, favRes]) => {\r\n        setHistoryItems(histRes.data || []);\r\n        setFavorites(favRes.data || []);\r\n        setError('');\r\n      })\r\n      .catch(() => {\r\n        setError('Failed to load your history or favorites.');\r\n      })\r\n      .finally(() => {\r\n        setLoading(false);\r\n      });\r\n  }, []);\r\n\r\n  const handleDeleteHistory = async (id) => {\r\n    try {\r\n      await deleteSearch(id);\r\n      setHistoryItems(items => items.filter(i => i.id !== id));\r\n    } catch {\r\n      setError('Could not delete that history item.');\r\n    }\r\n  };\r\n\r\n  const handleDeleteFavorite = async (id) => {\r\n    try {\r\n      await removeFavorite(id);\r\n      setFavorites(items => items.filter(i => i.id !== id));\r\n    } catch {\r\n      setError('Could not remove that favorite.');\r\n    }\r\n  };\r\n\r\n  const handleReRun = (query) => {\r\n    // Navigate to home with state (Home component can read location.state.query to auto-search)\r\n    navigate('/', { state: { query } });\r\n  };\r\n\r\n  if (!user) {\r\n    return (\r\n      <Container sx={{ py: 4, textAlign: 'center' }}>\r\n        <Typography variant=\"h6\">\r\n          Please sign in to view your history and favorites.\r\n        </Typography>\r\n        <Button variant=\"contained\" onClick={() => navigate('/login')} sx={{ mt: 2 }}>\r\n          Go to Sign In\r\n        </Button>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <Container sx={{ py: 4, textAlign: 'center' }}>\r\n        <CircularProgress />\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Container maxWidth=\"md\" sx={{ py: 4 }}>\r\n      <Typography variant=\"h4\" gutterBottom>\r\n        Your Activity\r\n      </Typography>\r\n      {error && <Alert severity=\"error\" sx={{ mb: 2 }}>{error}</Alert>}\r\n\r\n      <Tabs value={tab} onChange={(_, v) => setTab(v)} sx={{ mb: 2 }}>\r\n        <Tab label=\"Search History\" />\r\n        <Tab label=\"Favorites\" />\r\n      </Tabs>\r\n      <Divider />\r\n\r\n      {tab === 0 && (\r\n        <List>\r\n          {historyItems.length === 0 && (\r\n            <Typography sx={{ mt: 2 }}>No search history found.</Typography>\r\n          )}\r\n          {historyItems.map(item => (\r\n            <ListItem\r\n              key={item.id}\r\n              secondaryAction={\r\n                <>\r\n                  <IconButton\r\n                    edge=\"end\"\r\n                    aria-label=\"re-run search\"\r\n                    onClick={() => handleReRun(item.query)}\r\n                  >\r\n                    <ReplayIcon />\r\n                  </IconButton>\r\n                  <IconButton\r\n                    edge=\"end\"\r\n                    aria-label=\"delete history\"\r\n                    onClick={() => handleDeleteHistory(item.id)}\r\n                  >\r\n                    <DeleteIcon />\r\n                  </IconButton>\r\n                </>\r\n              }\r\n            >\r\n              <ListItemText\r\n                primary={item.query}\r\n                secondary={new Date(item.created_at).toLocaleString()}\r\n              />\r\n            </ListItem>\r\n          ))}\r\n        </List>\r\n      )}\r\n\r\n      {tab === 1 && (\r\n        <List>\r\n          {favorites.length === 0 && (\r\n            <Typography sx={{ mt: 2 }}>No favorites saved.</Typography>\r\n          )}\r\n          {favorites.map(item => (\r\n            <ListItem\r\n              key={item.id}\r\n              secondaryAction={\r\n                <IconButton\r\n                  edge=\"end\"\r\n                  aria-label=\"remove favorite\"\r\n                  onClick={() => handleDeleteFavorite(item.id)}\r\n                >\r\n                  <DeleteIcon />\r\n                </IconButton>\r\n              }\r\n            >\r\n              <ListItemText\r\n                primary={item.title || item.query}\r\n                secondary={new Date(item.created_at).toLocaleString()}\r\n              />\r\n            </ListItem>\r\n          ))}\r\n        </List>\r\n      )}\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default History;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}